{% extends 'base.html' %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h2>ğŸ—“ï¸ Agenda</h2>
  <span class="badge bg-success">Citas y vacunas programadas</span>
</div>

<div class="row">
  <div class="col-lg-6 mb-4">
    <div class="card h-100">
      <div class="card-body">
        <h5 class="card-title">ğŸ“… Citas</h5>
        {% if appointments %}
          <table class="table table-sm align-middle">
            <thead>
              <tr>
                <th>Mascota</th>
                <th>Fecha</th>
                <th>Tipo</th>
                <th>Notas</th>
              </tr>
            </thead>
            <tbody>
            {% for a in appointments %}
              {% set pet = pets|selectattr('id','equalto', a.pet_id)|list|first %}
              <tr>
                <td>{{ pet.name if pet else 'Desconocido' }}</td>
                <td>{{ a.date.strftime('%Y-%m-%d') }}</td>
                <td>{{ a.appointment_type }}</td>
                <td>{{ a.notes or '' }}</td>
              </tr>
            {% endfor %}
            </tbody>
          </table>
        {% else %}
          <p class="text-muted">No hay citas programadas.</p>
        {% endif %}
      </div>
    </div>
  </div>

  <div class="col-lg-6 mb-4">
    <div class="card h-100">
      <div class="card-body">
        <h5 class="card-title">ğŸ’‰ Vacunas/Tratamientos</h5>
        {% if treatments %}
          <table class="table table-sm align-middle">
            <thead>
              <tr>
                <th>Mascota</th>
                <th>Tipo</th>
                <th>Aplicado</th>
                <th>PrÃ³xima</th>
              </tr>
            </thead>
            <tbody>
            {% for t in treatments %}
              {% set pet = pets|selectattr('id','equalto', t.pet_id)|list|first %}
              <tr>
                <td>{{ pet.name if pet else 'Desconocido' }}</td>
                <td>{{ t.treatment_type }}</td>
                <td>{{ t.applied_date.strftime('%Y-%m-%d') }}</td>
                <td>{{ t.next_date.strftime('%Y-%m-%d') if t.next_date else '-' }}</td>
              </tr>
            {% endfor %}
            </tbody>
          </table>
        {% else %}
          <p class="text-muted">No hay tratamientos registrados.</p>
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endblock %}